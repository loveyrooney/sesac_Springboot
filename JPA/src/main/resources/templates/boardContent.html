<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Board Content</title>
    <style>
      .d-none {display:none;}
    </style>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
<header style="display:flex">
  <h1 style="margin-right: 20px;"><a href="/">Board</a></h1>
  <h1 style="margin-right: 20px;"><a href="/loginHome">login</a></h1>
</header>
<button><a href="/">목록으로</a></button>
<button th:classappend="${userid} != 'noname' ? '':'d-none'"><a th:href="'/modify/'+${board.getBoardId()}">수정/삭제</a></button>
<div>
  <div style="display:flex">
    <p style="margin-right: 20px;" th:text="${board.getBoardTitle()}">title</p>
    <p style="margin-right: 20px;" th:text="${board.getUserId()}">writer</p>
    <p style="margin-right: 20px;" th:text="${board.getBoardDate()}">date</p>
  </div>
  <hr>
  <div th:text="${board.getBoardContent()}">hello blabla</div>
  <hr>
  <div>
    <div style="display:flex">
      <p style="margin-right: 20px;">댓글작성자</p>
      <p style="margin-right: 20px;">댓글내용</p>
      <a style="margin-right: 20px;">❌</a>
    </div>
  </div>
  <table>
    <tr th:each="reply:${list}">
      <td th:text="${reply.getUserId()}"></td>
      <td th:text="${reply.getReplyContent()}"></td>
      <td th:text="${reply.getReplyDate()}"></td>
    </tr>
  </table>
  <form id="replyForm" th:classappend="${board.getBoardId()}">
    <input name="userId" th:value="${userid}" disabled/>
    <textarea name="replyContent" form="replyForm"></textarea>
    <input type="text" name="replyDate" disabled/>
    <button onclick="createReply()">등록</button>
  </form>
</div>
<script>
  const date = document.querySelector('input[name=replyDate]');
  let newDate = new Date;
  let today = `${newDate.getFullYear()}.${newDate.getMonth()+1}.${newDate.getDate()}`;
  date.value = today;

  function createReply(){
    let form = document.querySelector('#replyForm');
    console.log(form.className);
    axios.post(`/createReply`, {userId: form.userId.value, boardId: parseInt(form.className), replyContent: form.replyContent.value, replyDate: form.replyDate.value })
        .then((res)=>{
            console.log(res.data);
            //if(!res.data) alert("댓글 등록에 실패했습니다");
            //else window.location.reload();
        })
    }
</script>
</body>
</html>